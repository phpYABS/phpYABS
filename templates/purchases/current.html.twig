{% extends 'base.html.twig' %}
{% block title %}{{ 'purchase.evaluation.title'|trans }}{% endblock %}
{% block body_attr %}onLoad="document.libro.newISBN.focus()"{% endblock %}
{% block content %}
<section class="purchase-evaluation">
    <h1>{{ 'purchase.evaluation.title'|trans }}</h1>
    <h2>{{ 'purchase.evaluation.number'|trans }} {{ purchase_id }}</h2>

    {% if errmsg %}
        <p class="error-message">{{ errmsg }}</p>
    {% endif %}

    {% for acq in acquisto.acquisti %}
        {% include 'purchases/tabview.html.twig' with acq %}
    {% endfor %}

    {% if not trovato %}
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                alert('{{ 'purchase.evaluation.not_found'|trans }}');
            });
        </script>
    {% endif %}

    <div class="purchase-summary">
        <p>{{ 'purchase.evaluation.books_count'|trans({'%count%': acquisto.numBook}) }}</p>
        <ul>
            <li>{{ 'purchase.evaluation.total_cash'|trans }}: {{ acquisto.bill.totalec | format_currency('EUR') }}</li>
            <li>{{ 'purchase.evaluation.total_store_credit'|trans }}: {{ acquisto.bill.totaleb | format_currency('EUR') }}</li>
            <li>{{ 'purchase.evaluation.total_recycling'|trans }}: {{ acquisto.bill.totaler | format_currency('EUR') }}</li>
        </ul>
    </div>

    <div class="purchase-search">
        <form action="/purchases/current" method="post" name="libro">
            <label for="newISBN">{{ 'purchase.evaluation.isbn_ean'|trans }}</label>
            <input type="text" id="newISBN" name="newISBN" maxlength="13" required>
            <button type="submit">{{ 'purchase.search.button'|trans }}</button>
        </form>
    </div>
</section>
{% endblock content %}
